"use strict";

/*
 * MikoPBX - free phone system for small business
 * Copyright Â© 2017-2023 Alexey Portnov and Nikolay Beketov
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along with this program.
 * If not, see <https://www.gnu.org/licenses/>.
 */

/* global globalRootUrl, globalTranslate */

/**
 * The `firewallTable` object contains methods and variables for managing the Firewall system.
 *
 * @module firewallTable
 */
var firewallTable = {
  // The status toggle for enabling/disabling the firewall
  $statusToggle: $('#status-toggle'),
  // The button for adding a new rule
  $addNewButton: $('#add-new-button'),
  // The settings section
  $settings: $('#firewall-settings'),
  // This method initializes the Firewall management interface.
  initialize: function initialize() {
    // When a user double-clicks on a rule, they will be redirected to the modify page for that rule.
    $('.rule-row td').on('dblclick', function (e) {
      var id = $(e.target).closest('tr').attr('id');
      window.location = "".concat(globalRootUrl, "firewall/modify/").concat(id);
    }); // Setup checkbox to enable or disable the firewall.

    firewallTable.$statusToggle.checkbox({
      onChecked: firewallTable.enableFirewall,
      onUnchecked: firewallTable.disableFirewall
    });
  },
  // Enable the firewall by making an HTTP request to the server.
  enableFirewall: function enableFirewall() {
    $.api({
      url: "".concat(globalRootUrl, "firewall/enable"),
      on: 'now',
      onSuccess: function onSuccess(response) {
        response.success ? firewallTable.cbAfterEnabled(true) : firewallTable.cbAfterDisabled();
      }
    });
  },
  // Disable the firewall by making an HTTP request to the server.
  disableFirewall: function disableFirewall() {
    $.api({
      url: "".concat(globalRootUrl, "firewall/disable"),
      on: 'now',
      onSuccess: function onSuccess(response) {
        response.success ? firewallTable.cbAfterDisabled(true) : firewallTable.cbAfterEnabled();
      }
    });
  },
  // Callback after the firewall has been enabled.
  cbAfterEnabled: function cbAfterEnabled() {
    var sendEvent = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;
    firewallTable.$statusToggle.find('label').text(globalTranslate.fw_StatusEnabled);
    firewallTable.$statusToggle.checkbox('set checked');
    $('i.icon.checkmark.green[data-value="off"]').removeClass('checkmark green').addClass('close red');
    $('i.icon.corner.close').hide();

    if (sendEvent) {
      var event = document.createEvent('Event');
      event.initEvent('ConfigDataChanged', false, true);
      window.dispatchEvent(event);
    }
  },
  // Callback after the firewall has been disabled.
  cbAfterDisabled: function cbAfterDisabled() {
    var sendEvent = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;
    firewallTable.$statusToggle.find('label').text(globalTranslate.fw_StatusDisabled);
    firewallTable.$statusToggle.checkbox('set unchecked');
    $('i.icon.close.red[data-value="off"]').removeClass('close red').addClass('checkmark green');
    $('i.icon.corner.close').show();

    if (sendEvent) {
      var event = document.createEvent('Event');
      event.initEvent('ConfigDataChanged', false, true);
      window.dispatchEvent(event);
    }
  }
}; // When the document is ready, initialize the Firewall management interface.

$(document).ready(function () {
  firewallTable.initialize();
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9GaXJld2FsbC9maXJld2FsbC1pbmRleC5qcyJdLCJuYW1lcyI6WyJmaXJld2FsbFRhYmxlIiwiJHN0YXR1c1RvZ2dsZSIsIiQiLCIkYWRkTmV3QnV0dG9uIiwiJHNldHRpbmdzIiwiaW5pdGlhbGl6ZSIsIm9uIiwiZSIsImlkIiwidGFyZ2V0IiwiY2xvc2VzdCIsImF0dHIiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImdsb2JhbFJvb3RVcmwiLCJjaGVja2JveCIsIm9uQ2hlY2tlZCIsImVuYWJsZUZpcmV3YWxsIiwib25VbmNoZWNrZWQiLCJkaXNhYmxlRmlyZXdhbGwiLCJhcGkiLCJ1cmwiLCJvblN1Y2Nlc3MiLCJyZXNwb25zZSIsInN1Y2Nlc3MiLCJjYkFmdGVyRW5hYmxlZCIsImNiQWZ0ZXJEaXNhYmxlZCIsInNlbmRFdmVudCIsImZpbmQiLCJ0ZXh0IiwiZ2xvYmFsVHJhbnNsYXRlIiwiZndfU3RhdHVzRW5hYmxlZCIsInJlbW92ZUNsYXNzIiwiYWRkQ2xhc3MiLCJoaWRlIiwiZXZlbnQiLCJkb2N1bWVudCIsImNyZWF0ZUV2ZW50IiwiaW5pdEV2ZW50IiwiZGlzcGF0Y2hFdmVudCIsImZ3X1N0YXR1c0Rpc2FibGVkIiwic2hvdyIsInJlYWR5Il0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQU1BLGFBQWEsR0FBRztBQUNsQjtBQUNBQyxFQUFBQSxhQUFhLEVBQUVDLENBQUMsQ0FBQyxnQkFBRCxDQUZFO0FBSWxCO0FBQ0FDLEVBQUFBLGFBQWEsRUFBRUQsQ0FBQyxDQUFDLGlCQUFELENBTEU7QUFPbEI7QUFDQUUsRUFBQUEsU0FBUyxFQUFFRixDQUFDLENBQUMsb0JBQUQsQ0FSTTtBQVVsQjtBQUNBRyxFQUFBQSxVQVhrQix3QkFX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Q0FDaUIsV0FEakIsRUFFS0MsUUFGTCxDQUVjLGlCQUZkO0FBR0EvQixJQUFBQSxDQUFDLENBQUMscUJBQUQsQ0FBRCxDQUF5QnVDLElBQXpCOztBQUNBLFFBQUlkLFNBQUosRUFBZTtBQUNYLFVBQU1RLEtBQUssR0FBR0MsUUFBUSxDQUFDQyxXQUFULENBQXFCLE9BQXJCLENBQWQ7QUFDQUYsTUFBQUEsS0FBSyxDQUFDRyxTQUFOLENBQWdCLG1CQUFoQixFQUFxQyxLQUFyQyxFQUE0QyxJQUE1QztBQUNBMUIsTUFBQUEsTUFBTSxDQUFDMkIsYUFBUCxDQUFxQkosS0FBckI7QUFDSDtBQUNKO0FBaEZpQixDQUF0QixDLENBbUZBOztBQUNBakMsQ0FBQyxDQUFDa0MsUUFBRCxDQUFELENBQVlNLEtBQVosQ0FBa0IsWUFBTTtBQUNwQjFDLEVBQUFBLGFBQWEsQ0FBQ0ssVUFBZDtBQUNILENBRkQiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogTWlrb1BCWCAtIGZyZWUgcGhvbmUgc3lzdGVtIGZvciBzbWFsbCBidXNpbmVzc1xuICogQ29weXJpZ2h0IMKpIDIwMTctMjAyMyBBbGV4ZXkgUG9ydG5vdiBhbmQgTmlrb2xheSBCZWtldG92XG4gKlxuICogVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnlcbiAqIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5XG4gKiB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvclxuICogKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi5cbiAqXG4gKiBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCxcbiAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mXG4gKiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlXG4gKiBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLlxuICpcbiAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLlxuICogSWYgbm90LCBzZWUgPGh0dHBzOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi5cbiAqL1xuXG4vKiBnbG9iYWwgZ2xvYmFsUm9vdFVybCwgZ2xvYmFsVHJhbnNsYXRlICovXG5cbi8qKlxuICogVGhlIGBmaXJld2FsbFRhYmxlYCBvYmplY3QgY29udGFpbnMgbWV0aG9kcyBhbmQgdmFyaWFibGVzIGZvciBtYW5hZ2luZyB0aGUgRmlyZXdhbGwgc3lzdGVtLlxuICpcbiAqIEBtb2R1bGUgZmlyZXdhbGxUYWJsZVxuICovXG5jb25zdCBmaXJld2FsbFRhYmxlID0ge1xuICAgIC8vIFRoZSBzdGF0dXMgdG9nZ2xlIGZvciBlbmFibGluZy9kaXNhYmxpbmcgdGhlIGZpcmV3YWxsXG4gICAgJHN0YXR1c1RvZ2dsZTogJCgnI3N0YXR1cy10b2dnbGUnKSxcblxuICAgIC8vIFRoZSBidXR0b24gZm9yIGFkZGluZyBhIG5ldyBydWxlXG4gICAgJGFkZE5ld0J1dHRvbjogJCgnI2FkZC1uZXctYnV0dG9uJyksXG5cbiAgICAvLyBUaGUgc2V0dGluZ3Mgc2VjdGlvblxuICAgICRzZXR0aW5nczogJCgnI2ZpcmV3YWxsLXNldHRpbmdzJyksXG5cbiAgICAvLyBUaGlzIG1ldGhvZCBpbml0aWFsaXplcyB0aGUgRmlyZXdhbGwgbWFuYWdlbWVudCBpbnRlcmZhY2UuXG4gICAgaW5pdGlhbGl6ZSgpIHtcblxuICAgICAgICAvLyBXaGVuIGEgdXNlciBkb3VibGUtY2xpY2tzIG9uIGEgcnVsZSwgdGhleSB3aWxsIGJlIHJlZGlyZWN0ZWQgdG8gdGhlIG1vZGlmeSBwYWdlIGZvciB0aGF0IHJ1bGUuXG4gICAgICAgICQoJy5ydWxlLXJvdyB0ZCcpLm9uKCdkYmxjbGljaycsIChlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpZCA9ICQoZS50YXJnZXQpLmNsb3Nlc3QoJ3RyJykuYXR0cignaWQnKTtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9IGAke2dsb2JhbFJvb3RVcmx9ZmlyZXdhbGwvbW9kaWZ5LyR7aWR9YDtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gU2V0dXAgY2hlY2tib3ggdG8gZW5hYmxlIG9yIGRpc2FibGUgdGhlIGZpcmV3YWxsLlxuICAgICAgICBmaXJld2FsbFRhYmxlLiRzdGF0dXNUb2dnbGVcbiAgICAgICAgICAgIC5jaGVja2JveCh7XG4gICAgICAgICAgICAgICAgb25DaGVja2VkOiBmaXJld2FsbFRhYmxlLmVuYWJsZUZpcmV3YWxsLFxuICAgICAgICAgICAgICAgIG9uVW5jaGVja2VkOiBmaXJld2FsbFRhYmxlLmRpc2FibGVGaXJld2FsbCxcbiAgICAgICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvLyBFbmFibGUgdGhlIGZpcmV3YWxsIGJ5IG1ha2luZyBhbiBIVFRQIHJlcXVlc3QgdG8gdGhlIHNlcnZlci5cbiAgICBlbmFibGVGaXJld2FsbCgpIHtcbiAgICAgICAgJC5hcGkoe1xuICAgICAgICAgICAgdXJsOiBgJHtnbG9iYWxSb290VXJsfWZpcmV3YWxsL2VuYWJsZWAsXG4gICAgICAgICAgICBvbjogJ25vdycsXG4gICAgICAgICAgICBvblN1Y2Nlc3MocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICByZXNwb25zZS5zdWNjZXNzID8gZmlyZXdhbGxUYWJsZS5jYkFmdGVyRW5hYmxlZCh0cnVlKSA6IGZpcmV3YWxsVGFibGUuY2JBZnRlckRpc2FibGVkKCk7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvLyBEaXNhYmxlIHRoZSBmaXJld2FsbCBieSBtYWtpbmcgYW4gSFRUUCByZXF1ZXN0IHRvIHRoZSBzZXJ2ZXIuXG4gICAgZGlzYWJsZUZpcmV3YWxsKCkge1xuICAgICAgICAkLmFwaSh7XG4gICAgICAgICAgICB1cmw6IGAke2dsb2JhbFJvb3RVcmx9ZmlyZXdhbGwvZGlzYWJsZWAsXG4gICAgICAgICAgICBvbjogJ25vdycsXG4gICAgICAgICAgICBvblN1Y2Nlc3MocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICByZXNwb25zZS5zdWNjZXNzID8gZmlyZXdhbGxUYWJsZS5jYkFmdGVyRGlzYWJsZWQodHJ1ZSkgOiBmaXJld2FsbFRhYmxlLmNiQWZ0ZXJFbmFibGVkKCk7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvLyBDYWxsYmFjayBhZnRlciB0aGUgZmlyZXdhbGwgaGFzIGJlZW4gZW5hYmxlZC5cbiAgICBjYkFmdGVyRW5hYmxlZChzZW5kRXZlbnQgPSBmYWxzZSkge1xuICAgICAgICBmaXJld2FsbFRhYmxlLiRzdGF0dXNUb2dnbGUuZmluZCgnbGFiZWwnKS50ZXh0KGdsb2JhbFRyYW5zbGF0ZS5md19TdGF0dXNFbmFibGVkKTtcbiAgICAgICAgZmlyZXdhbGxUYWJsZS4kc3RhdHVzVG9nZ2xlLmNoZWNrYm94KCdzZXQgY2hlY2tlZCcpO1xuICAgICAgICAkKCdpLmljb24uY2hlY2ttYXJrLmdyZWVuW2RhdGEtdmFsdWU9XCJvZmZcIl0nKVxuICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdjaGVja21hcmsgZ3JlZW4nKVxuICAgICAgICAgICAgLmFkZENsYXNzKCdjbG9zZSByZWQnKTtcbiAgICAgICAgJCgnaS5pY29uLmNvcm5lci5jbG9zZScpLmhpZGUoKTtcblxuICAgICAgICBpZiAoc2VuZEV2ZW50KSB7XG4gICAgICAgICAgICBjb25zdCBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdFdmVudCcpO1xuICAgICAgICAgICAgZXZlbnQuaW5pdEV2ZW50KCdDb25maWdEYXRhQ2hhbmdlZCcsIGZhbHNlLCB0cnVlKTtcbiAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBDYWxsYmFjayBhZnRlciB0aGUgZmlyZXdhbGwgaGFzIGJlZW4gZGlzYWJsZWQuXG4gICAgY2JBZnRlckRpc2FibGVkKHNlbmRFdmVudCA9IGZhbHNlKSB7XG4gICAgICAgIGZpcmV3YWxsVGFibGUuJHN0YXR1c1RvZ2dsZS5maW5kKCdsYWJlbCcpLnRleHQoZ2xvYmFsVHJhbnNsYXRlLmZ3X1N0YXR1c0Rpc2FibGVkKTtcbiAgICAgICAgZmlyZXdhbGxUYWJsZS4kc3RhdHVzVG9nZ2xlLmNoZWNrYm94KCdzZXQgdW5jaGVja2VkJyk7XG4gICAgICAgICQoJ2kuaWNvbi5jbG9zZS5yZWRbZGF0YS12YWx1ZT1cIm9mZlwiXScpXG4gICAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ2Nsb3NlIHJlZCcpXG4gICAgICAgICAgICAuYWRkQ2xhc3MoJ2NoZWNrbWFyayBncmVlbicpO1xuICAgICAgICAkKCdpLmljb24uY29ybmVyLmNsb3NlJykuc2hvdygpO1xuICAgICAgICBpZiAoc2VuZEV2ZW50KSB7XG4gICAgICAgICAgICBjb25zdCBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdFdmVudCcpO1xuICAgICAgICAgICAgZXZlbnQuaW5pdEV2ZW50KCdDb25maWdEYXRhQ2hhbmdlZCcsIGZhbHNlLCB0cnVlKTtcbiAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgICAgICAgfVxuICAgIH0sXG59O1xuXG4vLyBXaGVuIHRoZSBkb2N1bWVudCBpcyByZWFkeSwgaW5pdGlhbGl6ZSB0aGUgRmlyZXdhbGwgbWFuYWdlbWVudCBpbnRlcmZhY2UuXG4kKGRvY3VtZW50KS5yZWFkeSgoKSA9PiB7XG4gICAgZmlyZXdhbGxUYWJsZS5pbml0aWFsaXplKCk7XG59KTtcblxuIl19