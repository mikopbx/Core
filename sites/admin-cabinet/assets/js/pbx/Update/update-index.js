"use strict";

/*
 * MikoPBX - free phone system for small business
 * Copyright Â© 2017-2023 Alexey Portnov and Nikolay Beketov
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along with this program.
 * If not, see <https://www.gnu.org/licenses/>.
 */

/* global PbxApi, globalPBXVersion, globalTranslate,
globalWebAdminLanguage, showdown, UserMessage, upgradeStatusLoopWorker, Config */

/**
 * Object for managing PBX firmware updates.
 *
 * @module updatePBX
 */
var updatePBX = {
  /**
   * jQuery object for the form.
   * @type {jQuery}
   */
  $formObj: $('#upgrade-form'),

  /**
   * jQuery object for the submit button.
   * @type {jQuery}
   */
  $submitButton: $('#submitbutton'),

  /**
   * jQuery object for the progress bar.
   * @type {jQuery}
   */
  $progressBar: $('#upload-progress-bar'),

  /**
   * jQuery object for the progress bar label.
   * @type {jQuery}
   */
  $progressBarLabel: $('#upload-progress-bar-label'),

  /**
   * Current version of the PBX firmware.
   * @type {string}
   */
  currentVersion: globalPBXVersion,

  /**
   * jQuery object for the modal form before upgrade.
   * @type {jQuery}
   */
  $upgradeModalForm: $('#update-modal-form'),

  /**
   * jQuery object for the "I have backup" input field.
   * @type {jQuery}
   */
  $iHaveBackupInput: $("input[name='i-have-backup-input']"),

  /**
   * jQuery object for the green button on modal form before upgrade.
   * @type {jQuery}
   */
  $startUpgradeButton: $('#start-upgrade-button'),

  /**
   * There is upgrade process working now flag.
   * @type {boolean}
   */
  upgradeInProgress: false,

  /**
   * Helps to convert markdown into html.
   * @type {Converter}
   */
  converter: new showdown.Converter(),

  /**
   * Initializes the update PBX firmware functionality.
   */
  initialize: function initialize() {
    // Open the upgrade modal form
    updatePBX.$upgradeModalForm.modal(); // Add 'disabled' class to submit button

    updatePBX.$submitButton.addClass('disabled'); // Trigger file input click when clicking on text input or button

    $('input:text, .ui.button', '.ui.action.input').on('click', function (e) {
      $('input:file', $(e.target).parents()).click();
    }); // Update text input value when selecting a file

    $('input:file', '.ui.action.input').on('change', function (e) {
      if (e.target.files[0] !== undefined) {
        var filename = e.target.files[0].name;
        $('input:text', $(e.target).parent()).val(filename);
        updatePBX.$submitButton.removeClass('disabled');
      }
    }); // Track the input field and make submit button available if phrase is equal to 'I have backup'

    updatePBX.$iHaveBackupInput.on('input', function (e) {
      if (updatePBX.$iHaveBackupInput.val() === globalTranslate.upd_EnterIHaveBackupPhrase) {
        updatePBX.$startUpgradeButton.removeClass('disabled');
      } else {
        updatePBX.$startUpgradeButton.addClass('disabled');
      }
    }); // Handle submit button click

    updatePBX.$submitButton.on('click', function (e) {
      e.preventDefault();
      if (updatePBX.$submitButton.hasClass('loading') || updatePBX.upgradeInProgress) return; // Validate the form and show the upgrade modal form on success

      updatePBX.$formObj.form({
        on: 'blur',
        fields: updatePBX.validateRules,
        onSuccess: function onSuccess() {
          updatePBX.$upgradeModalForm.modal({
            closable: false,
            onDeny: function onDeny() {
              return true;
            },
            onApprove: function onApprove() {
              // Start the file upload process
              updatePBX.$submitButton.addClass('loading');
              updatePBX.upgradeInProgress = true;
              var data = $('input:file')[0].files[0];
              PbxApi.FilesUploadFile(data, updatePBX.cbResumableUploadFile);
              return true;
            }
          }).modal('show');
        }
      }); // Validate the form

      updatePBX.$formObj.form('validate form');
    }); // Prepare the request data

    var requestData = {
      PBXVER: globalPBXVersion,
      LANGUAGE: globalWebAdminLanguage
    }; // Send an API request to check for new firmware

    $.api({
      url: "".concat(Config.updateUrl, "checkNewFirmware"),
      on: 'now',
      method: 'POST',
      data: requestData,
      successTest: function successTest(response) {
        // Test whether a JSON response is valid
        return response !== undefined && Object.keys(response).length > 0 && response.result === 'SUCCESS';
      },
      onSuccess: function onSuccess(response) {
        // Iterate through firmware objects and add version information
        var currentVerison = updatePBX.currentVersion.replace('-dev', '');
        response.firmware.forEach(function (obj) {
          var version = obj.version.replace('-dev', '');

          if (versionCompare(version, currentVerison) > 0) {
            updatePBX.addNewVersionInformation(obj);
          }
        }); // Handle redo button click

        $('a.redo').on('click', function (e) {
          e.preventDefault();
          if (updatePBX.$submitButton.hasClass('loading') || updatePBX.upgradeInProgress) return;
          updatePBX.$upgradeModalForm.modal({
            closable: false,
            onDeny: function onDeny() {
              return true;
            },
            onApprove: function onApprove() {
              // Prepare parameters for firmware download
              var params = {};
              var $aLink = $(e.target).closest('a');
              params.updateLink = $aLink.attr('href');
              params.md5 = $aLink.attr('data-md5');
              params.version = $aLink.attr('data-version');
              params.size = $aLink.attr('data-size');
              $aLink.find('i').addClass('loading');
              updatePBX.upgradeInProgress = true;
              PbxApi.FilesDownloadNewFirmware(params, updatePBX.cbAfterStartDownloadFirmware);
              return true;
            }
          }).modal('show');
        });
      }
    });
  },

  /**
   * Callback function for resumable file upload.
   * @param {string} action - The action of the upload.
   * @param {object} params - Additional parameters for the upload.
   */
  cbResumableUploadFile: function cbResumableUploadFile(action, params) {
    switch (action) {
      case 'fileSuccess':
        updatePBX.checkStatusFileMerging(params.response);
        break;

      case 'uploadStart':
        updatePBX.$submitButton.addClass('loading');
        updatePBX.$progressBar.show();
        updatePBX.$progressBarLabel.text(globalTranslate.upd_UploadInProgress);
        break;

      case 'progress':
        updatePBX.$progressBar.progress({
          percent: parseInt(params.percent, 10)
        });
        break;

      case 'error':
        updatePBX.$progressBarLabel.text(globalTranslate.upd_UploadError);
        updatePBX.$submitButton.removeClass('loading');
        UserMessage.showMultiString(globalTranslate.upd_UploadError);
        break;

      default:
    }
  },

  /**
   * Checks the status of the file merging process.
   * @param {string} response - The response from the /pbxcore/api/upload/status function.
   */
  checkStatusFileMerging: function checkStatusFileMerging(response) {
    if (response === undefined || PbxApi.tryParseJSON(response) === false) {
      UserMessage.showMultiString("".concat(globalTranslate.upd_UploadError));
      return;
    }

    var json = JSON.parse(response);

    if (json === undefined || json.data === undefined) {
      UserMessage.showMultiString("".concat(globalTranslate.upd_UploadError));
      return;
    }

    var fileID = json.data.upload_id;
    var filePath = json.data.filename; // Wait until system glued all parts of file

    mergingCheckWorker.initialize(fileID, filePath);
  },

  /**
   * Callback after start PBX upgrading
   * @param response
   */
  cbAfterStartUpdate: function cbAfterStartUpdate(response) {
    if (response.length === 0 || response === false) {
      UserMessage.showMultiString(globalTranslate.upd_UpgradeError);
      updatePBX.$submitButton.removeClass('loading');
    }
  },

  /**
   * After start online upgrade we have to wait an answer,
   * and then start status check worker
   */
  cbAfterStartDownloadFirmware: function cbAfterStartDownloadFirmware(response) {
    if (response.filename !== undefined) {
      upgradeStatusLoopWorker.initialize(response.filename);
    } else {
      updatePBX.upgradeInProgress = false;
      $('i.loading.redo').removeClass('loading');
    }
  },

  /**
   * Add new block of update information on page
   */
  addNewVersionInformation: function addNewVersionInformation(obj) {
    $('#online-updates-block').show();
    var markdownText = decodeURIComponent(obj.description);
    markdownText = markdownText.replace(/<br>/g, '\r');
    markdownText = markdownText.replace(/<br >/g, '\r');
    markdownText = markdownText.replace(/\* \*/g, '*');
    markdownText = markdownText.replace(/\*\*/g, '*');
    var html = updatePBX.converter.makeHtml(markdownText);
    var dymanicRow = "\n\t\t\t<tr class=\"update-row\">\n\t\t\t<td class=\"center aligned\">".concat(obj.version, "</td>\n\t\t\t<td>").concat(html, "</td>\n\t\t\t<td class=\"right aligned collapsing\">\n    \t\t<div class=\"ui small basic icon buttons action-buttons\">\n    \t\t\t<a href=\"").concat(obj.href, "\" class=\"ui button redo popuped\" \n    \t\t\t\tdata-content = \"").concat(globalTranslate.bt_ToolTipUpgradeOnline, "\"\n\t\t\t\t\tdata-md5 =\"").concat(obj.md5, "\" data-size =\"").concat(obj.size, "\"\n\t\t\t\t\tdata-version = \"").concat(obj.version, "\" >\n\t\t\t\t\t<i class=\"icon redo blue\"></i>\n\t\t\t\t\t<span class=\"percent\"></span>\n\t\t\t\t</a>\n\t\t\t\t<a href=\"").concat(obj.href, "\" class=\"ui button download popuped\" \n\t\t\t\t\tdata-content = \"").concat(globalTranslate.bt_ToolTipDownload, "\"\n\t\t\t\t\tdata-md5 =\"").concat(obj.md5, "\" data-size =\"").concat(obj.size, "\">\n\t\t\t\t\t<i class=\"icon download blue\"></i>\n\t\t\t\t</a>\n    \t\t</div>   \n\t</tr>");
    $('#updates-table tbody').append(dymanicRow);
    $('a.popuped').popup();
  }
}; // When the document is ready, initialize the update pbx firmware from image page

$(document).ready(function () {
  updatePBX.initialize();
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9VcGRhdGUvdXBkYXRlLWluZGV4LmpzIl0sIm5hbWVzIjpbInVwZGF0ZVBCWCIsIiRmb3JtT2JqIiwiJCIsIiRzdWJtaXRCdXR0b24iLCIkcHJvZ3Jlc3NCYXIiLCIkcHJvZ3Jlc3NCYXJMYWJlbCIsImN1cnJlbnRWZXJzaW9uIiwiZ2xvYmFsUEJYVmVyc2lvbiIsIiR1cGdyYWRlTW9kYWxGb3JtIiwiJGlIYXZlQmFja3VwSW5wdXQiLCIkc3RhcnRVcGdyYWRlQnV0dG9uIiwidXBncmFkZUluUHJvZ3Jlc3MiLCJjb252ZXJ0ZXIiLCJzaG93ZG93biIsIkNvbnZlcnRlciIsImluaXRpYWxpemUiLCJtb2RhbCIsImFkZENsYXNzIiwib24iLCJlIiwidGFyZ2V0IiwicGFyZW50cyIsImNsaWNrIiwiZmlsZXMiLCJ1bmRlZmluZWQiLCJmaWxlbmFtZSIsIm5hbWUiLCJwYXJlbnQiLCJ2YWwiLCJyZW1vdmVDbGFzcyIsImdsb2JhbFRyYW5zbGF0ZSIsInVwZF9FbnRlcklIYXZlQmFja3VwUGhyYXNlIiwicHJldmVudERlZmF1bHQiLCJoYXNDbGFzcyIsImZvcm0iLCJmaWVsZHMiLCJ2YWxpZGF0ZVJ1bGVzIiwib25TdWNjZXNzIiwiY2xvc2FibGUiLCJvbkRlbnkiLCJvbkFwcHJvdmUiLCJkYXRhIiwiUGJ4QXBpIiwiRmlsZXNVcGxvYWRGaWxlIiwiY2JSZXN1bWFibGVVcGxvYWRGaWxlIiwicmVxdWVzdERhdGEiLCJQQlhWRVIiLCJMQU5HVUFHRSIsImdsb2JhbFdlYkFkbWluTGFuZ3VhZ2UiLCJhcGkiLCJ1cmwiLCJDb25maWciLCJ1cGRhdGVVcmwiLCJtZXRob2QiLCJzdWNjZXNzVGVzdCIsInJlc3BvbnNlIiwiT2JqZWN0Iiwia2V5cyIsImxlbmd0aCIsInJlc3VsdCIsImN1cnJlbnRWZXJpc29uIiwicmVwbGFjZSIsImZpcm13YXJlIiwiZm9yRWFjaCIsIm9iaiIsInZlcnNpb24iLCJ2ZXJzaW9uQ29tcGFyZSIsImFkZE5ld1ZlcnNpb25JbmZvcm1hdGlvbiIsInBhcmFtcyIsIiRhTGluayIsImNsb3Nlc3QiLCJ1cGRhdGVMaW5rIiwiYXR0ciIsIm1kNSIsInNpemUiLCJmaW5kIiwiRmlsZXNEb3dubG9hZE5ld0Zpcm13YXJlIiwiY2JBZnRlclN0YXJ0RG93bmxvYWRGaXJtd2FyZSIsImFjdGlvbiIsImNoZWNrU3RhdHVzRmlsZU1lcmdpbmciLCJzaG93IiwidGV4dCIsInVwZF9VcGxvYWRJblByb2dyZXNzIiwicHJvZ3Jlc3MiLCJwZXJjZW50IiwicGFyc2VJbnQiLCJ1cGRfVXBsb2FkRXJyb3IiLCJVc2VyTWVzc2FnZSIsInNob3dNdWx0aVN0cmluZyIsInRyeVBhcnNlSlNPTiIsImpzb24iLCJKU09OIiwicGFyc2UiLCJmaWxlSUQiLCJ1cGxvYWRfaWQiLCJmaWxlUGF0aCIsIm1lcmdpbmdDaGVja1dvcmtlciIsImNiQWZ0ZXJTdGFydFVwZGF0ZSIsInVwZF9VcGdyYWRlRXJyb3IiLCJ1cGdyYWRlU3RhdHVzTG9vcFdvcmtlciIsIm1hcmtkb3duVGV4dCIsImRlY29kZVVSSUNvbXBvbmVudCIsImRlc2NyaXB0aW9uIiwiaHRtbCIsIm1ha2VIdG1sIiwiZHltYW5pY1JvdyIsImhyZWYiLCJidF9Ub29sVGlwVXBncmFkZU9ubGluZSIsImJ0X1Rvb2xUaXBEb3dubG9hZCIsImFwcGVuZCIsInBvcHVwIiwiZG9jdW1lbnQiLCJyZWFkeSJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQU1BLFNBQVMsR0FBRztBQUNkO0FBQ0o7QUFDQTtBQUNBO0FBQ0lDLEVBQUFBLFFBQVEsRUFBRUMsQ0FBQyxDQUFDLGVBQUQsQ0FMRzs7QUFPZDtBQUNKO0FBQ0E7QUFDQTtBQUNJQyxFQUFBQSxhQUFhLEVBQUVELENBQUMsQ0FBQyxlQUFELENB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QUFDSDtBQWpTYSxDQUFsQixDLENBb1NBOztBQUNBNUcsQ0FBQyxDQUFDNkcsUUFBRCxDQUFELENBQVlDLEtBQVosQ0FBa0IsWUFBTTtBQUNwQmhILEVBQUFBLFNBQVMsQ0FBQ2UsVUFBVjtBQUNILENBRkQiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogTWlrb1BCWCAtIGZyZWUgcGhvbmUgc3lzdGVtIGZvciBzbWFsbCBidXNpbmVzc1xuICogQ29weXJpZ2h0IMKpIDIwMTctMjAyMyBBbGV4ZXkgUG9ydG5vdiBhbmQgTmlrb2xheSBCZWtldG92XG4gKlxuICogVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnlcbiAqIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5XG4gKiB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvclxuICogKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi5cbiAqXG4gKiBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCxcbiAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mXG4gKiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlXG4gKiBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLlxuICpcbiAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLlxuICogSWYgbm90LCBzZWUgPGh0dHBzOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi5cbiAqL1xuXG4vKiBnbG9iYWwgUGJ4QXBpLCBnbG9iYWxQQlhWZXJzaW9uLCBnbG9iYWxUcmFuc2xhdGUsXG5nbG9iYWxXZWJBZG1pbkxhbmd1YWdlLCBzaG93ZG93biwgVXNlck1lc3NhZ2UsIHVwZ3JhZGVTdGF0dXNMb29wV29ya2VyLCBDb25maWcgKi9cblxuLyoqXG4gKiBPYmplY3QgZm9yIG1hbmFnaW5nIFBCWCBmaXJtd2FyZSB1cGRhdGVzLlxuICpcbiAqIEBtb2R1bGUgdXBkYXRlUEJYXG4gKi9cbmNvbnN0IHVwZGF0ZVBCWCA9IHtcbiAgICAvKipcbiAgICAgKiBqUXVlcnkgb2JqZWN0IGZvciB0aGUgZm9ybS5cbiAgICAgKiBAdHlwZSB7alF1ZXJ5fVxuICAgICAqL1xuICAgICRmb3JtT2JqOiAkKCcjdXBncmFkZS1mb3JtJyksXG5cbiAgICAvKipcbiAgICAgKiBqUXVlcnkgb2JqZWN0IGZvciB0aGUgc3VibWl0IGJ1dHRvbi5cbiAgICAgKiBAdHlwZSB7alF1ZXJ5fVxuICAgICAqL1xuICAgICRzdWJtaXRCdXR0b246ICQoJyNzdWJtaXRidXR0b24nKSxcblxuICAgIC8qKlxuICAgICAqIGpRdWVyeSBvYmplY3QgZm9yIHRoZSBwcm9ncmVzcyBiYXIuXG4gICAgICogQHR5cGUge2pRdWVyeX1cbiAgICAgKi9cbiAgICAkcHJvZ3Jlc3NCYXI6ICQoJyN1cGxvYWQtcHJvZ3Jlc3MtYmFyJyksXG5cbiAgICAvKipcbiAgICAgKiBqUXVlcnkgb2JqZWN0IGZvciB0aGUgcHJvZ3Jlc3MgYmFyIGxhYmVsLlxuICAgICAqIEB0eXBlIHtqUXVlcnl9XG4gICAgICovXG4gICAgJHByb2dyZXNzQmFyTGFiZWw6ICQoJyN1cGxvYWQtcHJvZ3Jlc3MtYmFyLWxhYmVsJyksXG5cbiAgICAvKipcbiAgICAgKiBDdXJyZW50IHZlcnNpb24gb2YgdGhlIFBCWCBmaXJtd2FyZS5cbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAqL1xuICAgIGN1cnJlbnRWZXJzaW9uOiBnbG9iYWxQQlhWZXJzaW9uLFxuXG4gICAgLyoqXG4gICAgICogalF1ZXJ5IG9iamVjdCBmb3IgdGhlIG1vZGFsIGZvcm0gYmVmb3JlIHVwZ3JhZGUuXG4gICAgICogQHR5cGUge2pRdWVyeX1cbiAgICAgKi9cbiAgICAkdXBncmFkZU1vZGFsRm9ybTogJCgnI3VwZGF0ZS1tb2RhbC1mb3JtJyksXG5cbiAgICAvKipcbiAgICAgKiBqUXVlcnkgb2JqZWN0IGZvciB0aGUgXCJJIGhhdmUgYmFja3VwXCIgaW5wdXQgZmllbGQuXG4gICAgICogQHR5cGUge2pRdWVyeX1cbiAgICAgKi9cbiAgICAkaUhhdmVCYWNrdXBJbnB1dDogJChcImlucHV0W25hbWU9J2ktaGF2ZS1iYWNrdXAtaW5wdXQnXVwiKSxcblxuICAgIC8qKlxuICAgICAqIGpRdWVyeSBvYmplY3QgZm9yIHRoZSBncmVlbiBidXR0b24gb24gbW9kYWwgZm9ybSBiZWZvcmUgdXBncmFkZS5cbiAgICAgKiBAdHlwZSB7alF1ZXJ5fVxuICAgICAqL1xuICAgICRzdGFydFVwZ3JhZGVCdXR0b246ICQoJyNzdGFydC11cGdyYWRlLWJ1dHRvbicpLFxuXG4gICAgLyoqXG4gICAgICogVGhlcmUgaXMgdXBncmFkZSBwcm9jZXNzIHdvcmtpbmcgbm93IGZsYWcuXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgdXBncmFkZUluUHJvZ3Jlc3M6IGZhbHNlLFxuXG4gICAgLyoqXG4gICAgICogSGVscHMgdG8gY29udmVydCBtYXJrZG93biBpbnRvIGh0bWwuXG4gICAgICogQHR5cGUge0NvbnZlcnRlcn1cbiAgICAgKi9cbiAgICBjb252ZXJ0ZXI6IG5ldyBzaG93ZG93bi5Db252ZXJ0ZXIoKSxcblxuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemVzIHRoZSB1cGRhdGUgUEJYIGZpcm13YXJlIGZ1bmN0aW9uYWxpdHkuXG4gICAgICovXG4gICAgaW5pdGlhbGl6ZSgpIHtcblxuICAgICAgICAvLyBPcGVuIHRoZSB1cGdyYWRlIG1vZGFsIGZvcm1cbiAgICAgICAgdXBkYXRlUEJYLiR1cGdyYWRlTW9kYWxGb3JtLm1vZGFsKCk7XG5cbiAgICAgICAgLy8gQWRkICdkaXNhYmxlZCcgY2xhc3MgdG8gc3VibWl0IGJ1dHRvblxuICAgICAgICB1cGRhdGVQQlguJHN1Ym1pdEJ1dHRvbi5hZGRDbGFzcygnZGlzYWJsZWQnKTtcblxuICAgICAgICAvLyBUcmlnZ2VyIGZpbGUgaW5wdXQgY2xpY2sgd2hlbiBjbGlja2luZyBvbiB0ZXh0IGlucHV0IG9yIGJ1dHRvblxuICAgICAgICAkKCdpbnB1dDp0ZXh0LCAudWkuYnV0dG9uJywgJy51aS5hY3Rpb24uaW5wdXQnKS5vbignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICAgICAgJCgnaW5wdXQ6ZmlsZScsICQoZS50YXJnZXQpLnBhcmVudHMoKSkuY2xpY2soKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gVXBkYXRlIHRleHQgaW5wdXQgdmFsdWUgd2hlbiBzZWxlY3RpbmcgYSBmaWxlXG4gICAgICAgICQoJ2lucHV0OmZpbGUnLCAnLnVpLmFjdGlvbi5pbnB1dCcpLm9uKCdjaGFuZ2UnLCAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKGUudGFyZ2V0LmZpbGVzWzBdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlbmFtZSA9IGUudGFyZ2V0LmZpbGVzWzBdLm5hbWU7XG4gICAgICAgICAgICAgICAgJCgnaW5wdXQ6dGV4dCcsICQoZS50YXJnZXQpLnBhcmVudCgpKS52YWwoZmlsZW5hbWUpO1xuICAgICAgICAgICAgICAgIHVwZGF0ZVBCWC4kc3VibWl0QnV0dG9uLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBUcmFjayB0aGUgaW5wdXQgZmllbGQgYW5kIG1ha2Ugc3VibWl0IGJ1dHRvbiBhdmFpbGFibGUgaWYgcGhyYXNlIGlzIGVxdWFsIHRvICdJIGhhdmUgYmFja3VwJ1xuICAgICAgICB1cGRhdGVQQlguJGlIYXZlQmFja3VwSW5wdXQub24oJ2lucHV0JywgKGUpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodXBkYXRlUEJYLiRpSGF2ZUJhY2t1cElucHV0LnZhbCgpPT09Z2xvYmFsVHJhbnNsYXRlLnVwZF9FbnRlcklIYXZlQmFja3VwUGhyYXNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZVBCWC4kc3RhcnRVcGdyYWRlQnV0dG9uLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZVBCWC4kc3RhcnRVcGdyYWRlQnV0dG9uLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gSGFuZGxlIHN1Ym1pdCBidXR0b24gY2xpY2tcbiAgICAgICAgdXBkYXRlUEJYLiRzdWJtaXRCdXR0b24ub24oJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGlmICh1cGRhdGVQQlguJHN1Ym1pdEJ1dHRvbi5oYXNDbGFzcygnbG9hZGluZycpIHx8IHVwZGF0ZVBCWC51cGdyYWRlSW5Qcm9ncmVzcykgcmV0dXJuO1xuXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSB0aGUgZm9ybSBhbmQgc2hvdyB0aGUgdXBncmFkZSBtb2RhbCBmb3JtIG9uIHN1Y2Nlc3NcbiAgICAgICAgICAgIHVwZGF0ZVBCWC4kZm9ybU9ialxuICAgICAgICAgICAgICAgIC5mb3JtKHtcbiAgICAgICAgICAgICAgICAgICAgb246ICdibHVyJyxcbiAgICAgICAgICAgICAgICAgICAgZmllbGRzOiB1cGRhdGVQQlgudmFsaWRhdGVSdWxlcyxcbiAgICAgICAgICAgICAgICAgICAgb25TdWNjZXNzKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlUEJYLiR1cGdyYWRlTW9kYWxGb3JtXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1vZGFsKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2FibGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkRlbnk6ICgpID0+IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQXBwcm92ZTogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3RhcnQgdGhlIGZpbGUgdXBsb2FkIHByb2Nlc3NcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVBCWC4kc3VibWl0QnV0dG9uLmFkZENsYXNzKCdsb2FkaW5nJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVQQlgudXBncmFkZUluUHJvZ3Jlc3MgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9ICQoJ2lucHV0OmZpbGUnKVswXS5maWxlc1swXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBieEFwaS5GaWxlc1VwbG9hZEZpbGUoZGF0YSwgdXBkYXRlUEJYLmNiUmVzdW1hYmxlVXBsb2FkRmlsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5tb2RhbCgnc2hvdycpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSB0aGUgZm9ybVxuICAgICAgICAgICAgdXBkYXRlUEJYLiRmb3JtT2JqLmZvcm0oJ3ZhbGlkYXRlIGZvcm0nKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gUHJlcGFyZSB0aGUgcmVxdWVzdCBkYXRhXG4gICAgICAgIGNvbnN0IHJlcXVlc3REYXRhID0ge1xuICAgICAgICAgICAgUEJYVkVSOiBnbG9iYWxQQlhWZXJzaW9uLFxuICAgICAgICAgICAgTEFOR1VBR0U6IGdsb2JhbFdlYkFkbWluTGFuZ3VhZ2UsXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gU2VuZCBhbiBBUEkgcmVxdWVzdCB0byBjaGVjayBmb3IgbmV3IGZpcm13YXJlXG4gICAgICAgICQuYXBpKHtcbiAgICAgICAgICAgIHVybDogYCR7Q29uZmlnLnVwZGF0ZVVybH1jaGVja05ld0Zpcm13YXJlYCxcbiAgICAgICAgICAgIG9uOiAnbm93JyxcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgZGF0YTogcmVxdWVzdERhdGEsXG4gICAgICAgICAgICBzdWNjZXNzVGVzdChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIC8vIFRlc3Qgd2hldGhlciBhIEpTT04gcmVzcG9uc2UgaXMgdmFsaWRcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UgIT09IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAmJiBPYmplY3Qua2V5cyhyZXNwb25zZSkubGVuZ3RoID4gMFxuICAgICAgICAgICAgICAgICAgICAmJiByZXNwb25zZS5yZXN1bHQgPT09ICdTVUNDRVNTJztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvblN1Y2Nlc3MocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAvLyBJdGVyYXRlIHRocm91Z2ggZmlybXdhcmUgb2JqZWN0cyBhbmQgYWRkIHZlcnNpb24gaW5mb3JtYXRpb25cbiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50VmVyaXNvbiA9IHVwZGF0ZVBCWC5jdXJyZW50VmVyc2lvbi5yZXBsYWNlKCctZGV2JywgJycpO1xuICAgICAgICAgICAgICAgIHJlc3BvbnNlLmZpcm13YXJlLmZvckVhY2goKG9iaikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2ZXJzaW9uID0gb2JqLnZlcnNpb24ucmVwbGFjZSgnLWRldicsICcnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZlcnNpb25Db21wYXJlKHZlcnNpb24sIGN1cnJlbnRWZXJpc29uKSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVBCWC5hZGROZXdWZXJzaW9uSW5mb3JtYXRpb24ob2JqKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8gSGFuZGxlIHJlZG8gYnV0dG9uIGNsaWNrXG4gICAgICAgICAgICAgICAgJCgnYS5yZWRvJykub24oJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodXBkYXRlUEJYLiRzdWJtaXRCdXR0b24uaGFzQ2xhc3MoJ2xvYWRpbmcnKSB8fCB1cGRhdGVQQlgudXBncmFkZUluUHJvZ3Jlc3MpIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlUEJYLiR1cGdyYWRlTW9kYWxGb3JtXG4gICAgICAgICAgICAgICAgICAgICAgICAubW9kYWwoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkRlbnk6ICgpID0+IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25BcHByb3ZlOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFByZXBhcmUgcGFyYW1ldGVycyBmb3IgZmlybXdhcmUgZG93bmxvYWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFyYW1zID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0ICRhTGluayA9ICQoZS50YXJnZXQpLmNsb3Nlc3QoJ2EnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLnVwZGF0ZUxpbmsgPSAkYUxpbmsuYXR0cignaHJlZicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMubWQ1ID0gJGFMaW5rLmF0dHIoJ2RhdGEtbWQ1Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy52ZXJzaW9uID0gJGFMaW5rLmF0dHIoJ2RhdGEtdmVyc2lvbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMuc2l6ZSA9ICRhTGluay5hdHRyKCdkYXRhLXNpemUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGFMaW5rLmZpbmQoJ2knKS5hZGRDbGFzcygnbG9hZGluZycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVQQlgudXBncmFkZUluUHJvZ3Jlc3MgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYnhBcGkuRmlsZXNEb3dubG9hZE5ld0Zpcm13YXJlKHBhcmFtcywgdXBkYXRlUEJYLmNiQWZ0ZXJTdGFydERvd25sb2FkRmlybXdhcmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5tb2RhbCgnc2hvdycpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIENhbGxiYWNrIGZ1bmN0aW9uIGZvciByZXN1bWFibGUgZmlsZSB1cGxvYWQuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGFjdGlvbiAtIFRoZSBhY3Rpb24gb2YgdGhlIHVwbG9hZC5cbiAgICAgKiBAcGFyYW0ge29iamVjdH0gcGFyYW1zIC0gQWRkaXRpb25hbCBwYXJhbWV0ZXJzIGZvciB0aGUgdXBsb2FkLlxuICAgICAqL1xuICAgIGNiUmVzdW1hYmxlVXBsb2FkRmlsZShhY3Rpb24sIHBhcmFtcykge1xuICAgICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICAgICAgY2FzZSAnZmlsZVN1Y2Nlc3MnOlxuICAgICAgICAgICAgICAgIHVwZGF0ZVBCWC5jaGVja1N0YXR1c0ZpbGVNZXJnaW5nKHBhcmFtcy5yZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICd1cGxvYWRTdGFydCc6XG4gICAgICAgICAgICAgICAgdXBkYXRlUEJYLiRzdWJtaXRCdXR0b24uYWRkQ2xhc3MoJ2xvYWRpbmcnKTtcbiAgICAgICAgICAgICAgICB1cGRhdGVQQlguJHByb2dyZXNzQmFyLnNob3coKTtcbiAgICAgICAgICAgICAgICB1cGRhdGVQQlguJHByb2dyZXNzQmFyTGFiZWwudGV4dChnbG9iYWxUcmFuc2xhdGUudXBkX1VwbG9hZEluUHJvZ3Jlc3MpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAncHJvZ3Jlc3MnOlxuICAgICAgICAgICAgICAgIHVwZGF0ZVBCWC4kcHJvZ3Jlc3NCYXIucHJvZ3Jlc3Moe1xuICAgICAgICAgICAgICAgICAgICBwZXJjZW50OiBwYXJzZUludChwYXJhbXMucGVyY2VudCwgMTApLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZXJyb3InOlxuICAgICAgICAgICAgICAgIHVwZGF0ZVBCWC4kcHJvZ3Jlc3NCYXJMYWJlbC50ZXh0KGdsb2JhbFRyYW5zbGF0ZS51cGRfVXBsb2FkRXJyb3IpO1xuICAgICAgICAgICAgICAgIHVwZGF0ZVBCWC4kc3VibWl0QnV0dG9uLnJlbW92ZUNsYXNzKCdsb2FkaW5nJyk7XG4gICAgICAgICAgICAgICAgVXNlck1lc3NhZ2Uuc2hvd011bHRpU3RyaW5nKGdsb2JhbFRyYW5zbGF0ZS51cGRfVXBsb2FkRXJyb3IpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgdGhlIHN0YXR1cyBvZiB0aGUgZmlsZSBtZXJnaW5nIHByb2Nlc3MuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHJlc3BvbnNlIC0gVGhlIHJlc3BvbnNlIGZyb20gdGhlIC9wYnhjb3JlL2FwaS91cGxvYWQvc3RhdHVzIGZ1bmN0aW9uLlxuICAgICAqL1xuICAgIGNoZWNrU3RhdHVzRmlsZU1lcmdpbmcocmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKHJlc3BvbnNlID09PSB1bmRlZmluZWQgfHwgUGJ4QXBpLnRyeVBhcnNlSlNPTihyZXNwb25zZSkgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICBVc2VyTWVzc2FnZS5zaG93TXVsdGlTdHJpbmcoYCR7Z2xvYmFsVHJhbnNsYXRlLnVwZF9VcGxvYWRFcnJvcn1gKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBqc29uID0gSlNPTi5wYXJzZShyZXNwb25zZSk7XG4gICAgICAgIGlmIChqc29uID09PSB1bmRlZmluZWQgfHwganNvbi5kYXRhID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIFVzZXJNZXNzYWdlLnNob3dNdWx0aVN0cmluZyhgJHtnbG9iYWxUcmFuc2xhdGUudXBkX1VwbG9hZEVycm9yfWApO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGZpbGVJRCA9IGpzb24uZGF0YS51cGxvYWRfaWQ7XG4gICAgICAgIGNvbnN0IGZpbGVQYXRoID0ganNvbi5kYXRhLmZpbGVuYW1lO1xuICAgICAgICAvLyBXYWl0IHVudGlsIHN5c3RlbSBnbHVlZCBhbGwgcGFydHMgb2YgZmlsZVxuICAgICAgICBtZXJnaW5nQ2hlY2tXb3JrZXIuaW5pdGlhbGl6ZShmaWxlSUQsIGZpbGVQYXRoKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogQ2FsbGJhY2sgYWZ0ZXIgc3RhcnQgUEJYIHVwZ3JhZGluZ1xuICAgICAqIEBwYXJhbSByZXNwb25zZVxuICAgICAqL1xuICAgIGNiQWZ0ZXJTdGFydFVwZGF0ZShyZXNwb25zZSkge1xuICAgICAgICBpZiAocmVzcG9uc2UubGVuZ3RoID09PSAwIHx8IHJlc3BvbnNlID09PSBmYWxzZSkge1xuICAgICAgICAgICAgVXNlck1lc3NhZ2Uuc2hvd011bHRpU3RyaW5nKGdsb2JhbFRyYW5zbGF0ZS51cGRfVXBncmFkZUVycm9yKTtcbiAgICAgICAgICAgIHVwZGF0ZVBCWC4kc3VibWl0QnV0dG9uLnJlbW92ZUNsYXNzKCdsb2FkaW5nJyk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogQWZ0ZXIgc3RhcnQgb25saW5lIHVwZ3JhZGUgd2UgaGF2ZSB0byB3YWl0IGFuIGFuc3dlcixcbiAgICAgKiBhbmQgdGhlbiBzdGFydCBzdGF0dXMgY2hlY2sgd29ya2VyXG4gICAgICovXG4gICAgY2JBZnRlclN0YXJ0RG93bmxvYWRGaXJtd2FyZShyZXNwb25zZSkge1xuICAgICAgICBpZiAocmVzcG9uc2UuZmlsZW5hbWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdXBncmFkZVN0YXR1c0xvb3BXb3JrZXIuaW5pdGlhbGl6ZShyZXNwb25zZS5maWxlbmFtZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB1cGRhdGVQQlgudXBncmFkZUluUHJvZ3Jlc3MgPSBmYWxzZTtcbiAgICAgICAgICAgICQoJ2kubG9hZGluZy5yZWRvJykucmVtb3ZlQ2xhc3MoJ2xvYWRpbmcnKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBBZGQgbmV3IGJsb2NrIG9mIHVwZGF0ZSBpbmZvcm1hdGlvbiBvbiBwYWdlXG4gICAgICovXG4gICAgYWRkTmV3VmVyc2lvbkluZm9ybWF0aW9uKG9iaikge1xuICAgICAgICAkKCcjb25saW5lLXVwZGF0ZXMtYmxvY2snKS5zaG93KCk7XG4gICAgICAgIGxldCBtYXJrZG93blRleHQgPSBkZWNvZGVVUklDb21wb25lbnQob2JqLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgbWFya2Rvd25UZXh0ID0gbWFya2Rvd25UZXh0LnJlcGxhY2UoLzxicj4vZywgJ1xccicpO1xuICAgICAgICBtYXJrZG93blRleHQgPSBtYXJrZG93blRleHQucmVwbGFjZSgvPGJyID4vZywgJ1xccicpO1xuICAgICAgICBtYXJrZG93blRleHQgPSBtYXJrZG93blRleHQucmVwbGFjZSgvXFwqIFxcKi9nLCAnKicpO1xuICAgICAgICBtYXJrZG93blRleHQgPSBtYXJrZG93blRleHQucmVwbGFjZSgvXFwqXFwqL2csICcqJyk7XG4gICAgICAgIGNvbnN0IGh0bWwgPSB1cGRhdGVQQlguY29udmVydGVyLm1ha2VIdG1sKG1hcmtkb3duVGV4dCk7XG4gICAgICAgIGNvbnN0IGR5bWFuaWNSb3cgPSBgXG5cdFx0XHQ8dHIgY2xhc3M9XCJ1cGRhdGUtcm93XCI+XG5cdFx0XHQ8dGQgY2xhc3M9XCJjZW50ZXIgYWxpZ25lZFwiPiR7b2JqLnZlcnNpb259PC90ZD5cblx0XHRcdDx0ZD4ke2h0bWx9PC90ZD5cblx0XHRcdDx0ZCBjbGFzcz1cInJpZ2h0IGFsaWduZWQgY29sbGFwc2luZ1wiPlxuICAgIFx0XHQ8ZGl2IGNsYXNzPVwidWkgc21hbGwgYmFzaWMgaWNvbiBidXR0b25zIGFjdGlvbi1idXR0b25zXCI+XG4gICAgXHRcdFx0PGEgaHJlZj1cIiR7b2JqLmhyZWZ9XCIgY2xhc3M9XCJ1aSBidXR0b24gcmVkbyBwb3B1cGVkXCIgXG4gICAgXHRcdFx0XHRkYXRhLWNvbnRlbnQgPSBcIiR7Z2xvYmFsVHJhbnNsYXRlLmJ0X1Rvb2xUaXBVcGdyYWRlT25saW5lfVwiXG5cdFx0XHRcdFx0ZGF0YS1tZDUgPVwiJHtvYmoubWQ1fVwiIGRhdGEtc2l6ZSA9XCIke29iai5zaXplfVwiXG5cdFx0XHRcdFx0ZGF0YS12ZXJzaW9uID0gXCIke29iai52ZXJzaW9ufVwiID5cblx0XHRcdFx0XHQ8aSBjbGFzcz1cImljb24gcmVkbyBibHVlXCI+PC9pPlxuXHRcdFx0XHRcdDxzcGFuIGNsYXNzPVwicGVyY2VudFwiPjwvc3Bhbj5cblx0XHRcdFx0PC9hPlxuXHRcdFx0XHQ8YSBocmVmPVwiJHtvYmouaHJlZn1cIiBjbGFzcz1cInVpIGJ1dHRvbiBkb3dubG9hZCBwb3B1cGVkXCIgXG5cdFx0XHRcdFx0ZGF0YS1jb250ZW50ID0gXCIke2dsb2JhbFRyYW5zbGF0ZS5idF9Ub29sVGlwRG93bmxvYWR9XCJcblx0XHRcdFx0XHRkYXRhLW1kNSA9XCIke29iai5tZDV9XCIgZGF0YS1zaXplID1cIiR7b2JqLnNpemV9XCI+XG5cdFx0XHRcdFx0PGkgY2xhc3M9XCJpY29uIGRvd25sb2FkIGJsdWVcIj48L2k+XG5cdFx0XHRcdDwvYT5cbiAgICBcdFx0PC9kaXY+ICAgXG5cdDwvdHI+YDtcbiAgICAgICAgJCgnI3VwZGF0ZXMtdGFibGUgdGJvZHknKS5hcHBlbmQoZHltYW5pY1Jvdyk7XG4gICAgICAgICQoJ2EucG9wdXBlZCcpLnBvcHVwKCk7XG4gICAgfSxcbn07XG5cbi8vIFdoZW4gdGhlIGRvY3VtZW50IGlzIHJlYWR5LCBpbml0aWFsaXplIHRoZSB1cGRhdGUgcGJ4IGZpcm13YXJlIGZyb20gaW1hZ2UgcGFnZVxuJChkb2N1bWVudCkucmVhZHkoKCkgPT4ge1xuICAgIHVwZGF0ZVBCWC5pbml0aWFsaXplKCk7XG59KTtcblxuIl19