"use strict";

/*
 * MikoPBX - free phone system for small business
 * Copyright (C) 2017-2020 Alexey Portnov and Nikolay Beketov
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along with this program.
 * If not, see <https://www.gnu.org/licenses/>.
 */

/* global globalTranslate, PbxApi, DebuggerInfo */
var providersStatusLoopWorker = {
  timeOut: 3000,
  $formObj: $('#save-provider-form'),
  timeOutHandle: '',
  $status: $('#status'),
  initialize: function initialize() {
    // Запустим обновление статуса провайдера
    DebuggerInfo.initialize();
    providersStatusLoopWorker.restartWorker();
  },
  restartWorker: function restartWorker() {
    window.clearTimeout(providersStatusLoopWorker.timeoutHandle);
    providersStatusLoopWorker.worker();
  },
  worker: function worker() {
    window.clearTimeout(providersStatusLoopWorker.timeoutHandle);

    switch (provider.providerType) {
      case 'SIP':
        PbxApi.GetSipProvidersStatuses(providersStatusLoopWorker.cbRefreshProvidersStatus);
        break;

      case 'IAX':
        PbxApi.GetIaxProvidersStatuses(providersStatusLoopWorker.cbRefreshProvidersStatus);
        break;

      default:
    }
  },
  cbRefreshProvidersStatus: function cbRefreshProvidersStatus(response) {
    providersStatusLoopWorker.timeoutHandle = window.setTimeout(providersStatusLoopWorker.worker, providersStatusLoopWorker.timeOut);
    if (response.length === 0 || response === false) return;
    var htmlTable = '<table class="ui very compact table">';
    $.each(response, function (key, value) {
      htmlTable += '<tr>';
      htmlTable += "<td>".concat(value.id, "</td>");
      htmlTable += "<td>".concat(value.state, "</td>");
      htmlTable += '</tr>';
    });
    htmlTable += '</table>';
    DebuggerInfo.UpdateContent(htmlTable);
    var uniqid = providersStatusLoopWorker.$formObj.form('get value', 'uniqid');
    var result = $.grep(response, function (e) {
      var respid = e.id;
      return respid.toUpperCase() === uniqid.toUpperCase();
    });

    if (result.length === 0) {
      // not found
      providersStatusLoopWorker.$status.removeClass('green').removeClass('yellow').addClass('grey');
    } else if (result[0] !== undefined && result[0].state.toUpperCase() === 'REGISTERED') {
      providersStatusLoopWorker.$status.removeClass('grey').removeClass('yellow').addClass('green');
    } else if (result[0] !== undefined && result[0].state.toUpperCase() === 'OK') {
      providersStatusLoopWorker.$status.removeClass('grey').removeClass('green').addClass('yellow');
    } else {
      providersStatusLoopWorker.$status.removeClass('green').removeClass('yellow').addClass('grey');
    }

    if (providersStatusLoopWorker.$status.hasClass('green')) {
      providersStatusLoopWorker.$status.html(globalTranslate.pr_Online);
    } else if (providersStatusLoopWorker.$status.hasClass('yellow')) {
      providersStatusLoopWorker.$status.html(globalTranslate.pr_WithoutRegistration);
    } else {
      providersStatusLoopWorker.$status.html(globalTranslate.pr_Offline);
    }
  }
};
$(document).ready(function () {
  providersStatusLoopWorker.initialize();
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9Qcm92aWRlcnMvcHJvdmlkZXItbW9kaWZ5LXN0YXR1cy13b3JrZXIuanMiXSwibmFtZXMiOlsicHJvdmlkZXJzU3RhdHVzTG9vcFdvcmtlciIsInRpbWVPdXQiLCIkZm9ybU9iaiIsIiQiLCJ0aW1lT3V0SGFuZGxlIiwiJHN0YXR1cyIsImluaXRpYWxpemUiLCJEZWJ1Z2dlckluZm8iLCJyZXN0YXJ0V29ya2VyIiwid2luZG93IiwiY2xlYXJUaW1lb3V0IiwidGltZW91dEhhbmRsZSIsIndvcmtlciIsInByb3ZpZGVyIiwicHJvdmlkZXJUeXBlIiwiUGJ4QXBpIiwiR2V0U2lwUHJvdmlkZXJzU3RhdHVzZXMiLCJjYlJlZnJlc2hQcm92aWRlcnNTdGF0dXMiLCJHZXRJYXhQcm92aWRlcnNTdGF0dXNlcyIsInJlc3BvbnNlIiwic2V0VGltZW91dCIsImxlbmd0aCIsImh0bWxUYWJsZSIsImVhY2giLCJrZXkiLCJ2YWx1ZSIsImlkIiwic3RhdGUiLCJVcGRhdGVDb250ZW50IiwidW5pcWlkIiwiZm9ybSIsInJlc3VsdCIsImdyZXAiLCJlIiwicmVzcGlkIiwidG9VcHBlckNhc2UiLCJyZW1vdmVDbGFzcyIsImFkZENsYXNzIiwidW5kZWZpbmVkIiwiaGFzQ2xhc3MiLCJodG1sIiwiZ2xvYmFsVHJhbnNsYXRlIiwicHJfT25saW5lIiwicHJfV2l0aG91dFJlZ2lzdHJhdGlvbiIsInByX09mZmxpbmUiLCJkb2N1bWVudCIsInJlYWR5Il0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFFQSxJQUFNQSx5QkFBeUIsR0FBRztBQUNqQ0MsRUFBQUEsT0FBTyxFQUFFLElBRHdCO0FBRWpDQyxFQUFBQSxRQUFRLEVBQUVDLENBQUMsQ0FBQyxxQkFBRCxDQUZzQjtBQUdqQ0MsRUFBQUEsYUFBYSxFQUFFLEVB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Q0FBQyxDQUFELENBQU4sS0FBY08sU0FBZCxJQUEyQlAsTUFBTSxDQUFDLENBQUQsQ0FBTixDQUFVSixLQUFWLENBQWdCUSxXQUFoQixPQUFrQyxJQUFqRSxFQUF1RTtBQUM3RW5DLE1BQUFBLHlCQUF5QixDQUFDSyxPQUExQixDQUFrQytCLFdBQWxDLENBQThDLE1BQTlDLEVBQXNEQSxXQUF0RCxDQUFrRSxPQUFsRSxFQUEyRUMsUUFBM0UsQ0FBb0YsUUFBcEY7QUFDQSxLQUZNLE1BRUE7QUFDTnJDLE1BQUFBLHlCQUF5QixDQUFDSyxPQUExQixDQUFrQytCLFdBQWxDLENBQThDLE9BQTlDLEVBQXVEQSxXQUF2RCxDQUFtRSxRQUFuRSxFQUE2RUMsUUFBN0UsQ0FBc0YsTUFBdEY7QUFDQTs7QUFFRCxRQUFJckMseUJBQXlCLENBQUNLLE9BQTFCLENBQWtDa0MsUUFBbEMsQ0FBMkMsT0FBM0MsQ0FBSixFQUF5RDtBQUN4RHZDLE1BQUFBLHlCQUF5QixDQUFDSyxPQUExQixDQUFrQ21DLElBQWxDLENBQXVDQyxlQUFlLENBQUNDLFNBQXZEO0FBQ0EsS0FGRCxNQUVPLElBQUkxQyx5QkFBeUIsQ0FBQ0ssT0FBMUIsQ0FBa0NrQyxRQUFsQyxDQUEyQyxRQUEzQyxDQUFKLEVBQTBEO0FBQ2hFdkMsTUFBQUEseUJBQXlCLENBQUNLLE9BQTFCLENBQWtDbUMsSUFBbEMsQ0FBdUNDLGVBQWUsQ0FBQ0Usc0JBQXZEO0FBQ0EsS0FGTSxNQUVBO0FBQ04zQyxNQUFBQSx5QkFBeUIsQ0FBQ0ssT0FBMUIsQ0FBa0NtQyxJQUFsQyxDQUF1Q0MsZUFBZSxDQUFDRyxVQUF2RDtBQUNBO0FBQ0Q7QUE5RGdDLENBQWxDO0FBa0VBekMsQ0FBQyxDQUFDMEMsUUFBRCxDQUFELENBQVlDLEtBQVosQ0FBa0IsWUFBTTtBQUN2QjlDLEVBQUFBLHlCQUF5QixDQUFDTSxVQUExQjtBQUNBLENBRkQiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogTWlrb1BCWCAtIGZyZWUgcGhvbmUgc3lzdGVtIGZvciBzbWFsbCBidXNpbmVzc1xuICogQ29weXJpZ2h0IChDKSAyMDE3LTIwMjAgQWxleGV5IFBvcnRub3YgYW5kIE5pa29sYXkgQmVrZXRvdlxuICpcbiAqIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5XG4gKiBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieVxuICogdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMyBvZiB0aGUgTGljZW5zZSwgb3JcbiAqIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uXG4gKlxuICogVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsXG4gKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZlxuICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZVxuICogR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy5cbiAqXG4gKiBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS5cbiAqIElmIG5vdCwgc2VlIDxodHRwczovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uXG4gKi9cblxuLyogZ2xvYmFsIGdsb2JhbFRyYW5zbGF0ZSwgUGJ4QXBpLCBEZWJ1Z2dlckluZm8gKi9cblxuY29uc3QgcHJvdmlkZXJzU3RhdHVzTG9vcFdvcmtlciA9IHtcblx0dGltZU91dDogMzAwMCxcblx0JGZvcm1PYmo6ICQoJyNzYXZlLXByb3ZpZGVyLWZvcm0nKSxcblx0dGltZU91dEhhbmRsZTogJycsXG5cdCRzdGF0dXM6ICQoJyNzdGF0dXMnKSxcblx0aW5pdGlhbGl6ZSgpIHtcblx0XHQvLyDQl9Cw0L/Rg9GB0YLQuNC8INC+0LHQvdC+0LLQu9C10L3QuNC1INGB0YLQsNGC0YPRgdCwINC/0YDQvtCy0LDQudC00LXRgNCwXG5cdFx0RGVidWdnZXJJbmZvLmluaXRpYWxpemUoKTtcblx0XHRwcm92aWRlcnNTdGF0dXNMb29wV29ya2VyLnJlc3RhcnRXb3JrZXIoKTtcblx0fSxcblx0cmVzdGFydFdvcmtlcigpIHtcblx0XHR3aW5kb3cuY2xlYXJUaW1lb3V0KHByb3ZpZGVyc1N0YXR1c0xvb3BXb3JrZXIudGltZW91dEhhbmRsZSk7XG5cdFx0cHJvdmlkZXJzU3RhdHVzTG9vcFdvcmtlci53b3JrZXIoKTtcblx0fSxcblx0d29ya2VyKCkge1xuXHRcdHdpbmRvdy5jbGVhclRpbWVvdXQocHJvdmlkZXJzU3RhdHVzTG9vcFdvcmtlci50aW1lb3V0SGFuZGxlKTtcblx0XHRzd2l0Y2ggKHByb3ZpZGVyLnByb3ZpZGVyVHlwZSkge1xuXHRcdFx0Y2FzZSAnU0lQJzpcblx0XHRcdFx0UGJ4QXBpLkdldFNpcFByb3ZpZGVyc1N0YXR1c2VzKHByb3ZpZGVyc1N0YXR1c0xvb3BXb3JrZXIuY2JSZWZyZXNoUHJvdmlkZXJzU3RhdHVzKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlICdJQVgnOlxuXHRcdFx0XHRQYnhBcGkuR2V0SWF4UHJvdmlkZXJzU3RhdHVzZXMocHJvdmlkZXJzU3RhdHVzTG9vcFdvcmtlci5jYlJlZnJlc2hQcm92aWRlcnNTdGF0dXMpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGRlZmF1bHQ6XG5cdFx0fVxuXHR9LFxuXHRjYlJlZnJlc2hQcm92aWRlcnNTdGF0dXMocmVzcG9uc2UpIHtcblx0XHRwcm92aWRlcnNTdGF0dXNMb29wV29ya2VyLnRpbWVvdXRIYW5kbGUgPVxuXHRcdFx0d2luZG93LnNldFRpbWVvdXQocHJvdmlkZXJzU3RhdHVzTG9vcFdvcmtlci53b3JrZXIsIHByb3ZpZGVyc1N0YXR1c0xvb3BXb3JrZXIudGltZU91dCk7XG5cdFx0aWYgKHJlc3BvbnNlLmxlbmd0aCA9PT0gMCB8fCByZXNwb25zZSA9PT0gZmFsc2UpIHJldHVybjtcblx0XHRsZXQgaHRtbFRhYmxlID0gJzx0YWJsZSBjbGFzcz1cInVpIHZlcnkgY29tcGFjdCB0YWJsZVwiPic7XG5cdFx0JC5lYWNoKHJlc3BvbnNlLCAoa2V5LCB2YWx1ZSkgPT4ge1xuXHRcdFx0aHRtbFRhYmxlICs9ICc8dHI+Jztcblx0XHRcdGh0bWxUYWJsZSArPSBgPHRkPiR7dmFsdWUuaWR9PC90ZD5gO1xuXHRcdFx0aHRtbFRhYmxlICs9IGA8dGQ+JHt2YWx1ZS5zdGF0ZX08L3RkPmA7XG5cdFx0XHRodG1sVGFibGUgKz0gJzwvdHI+Jztcblx0XHR9KTtcblx0XHRodG1sVGFibGUgKz0gJzwvdGFibGU+Jztcblx0XHREZWJ1Z2dlckluZm8uVXBkYXRlQ29udGVudChodG1sVGFibGUpO1xuXHRcdGNvbnN0IHVuaXFpZCA9IHByb3ZpZGVyc1N0YXR1c0xvb3BXb3JrZXIuJGZvcm1PYmouZm9ybSgnZ2V0IHZhbHVlJywgJ3VuaXFpZCcpO1xuXHRcdGNvbnN0IHJlc3VsdCA9ICQuZ3JlcChyZXNwb25zZSwgKGUpID0+IHtcblx0XHRcdGNvbnN0IHJlc3BpZCA9IGUuaWQ7XG5cdFx0XHRyZXR1cm4gcmVzcGlkLnRvVXBwZXJDYXNlKCkgPT09IHVuaXFpZC50b1VwcGVyQ2FzZSgpO1xuXHRcdH0pO1xuXHRcdGlmIChyZXN1bHQubGVuZ3RoID09PSAwKSB7XG5cdFx0XHQvLyBub3QgZm91bmRcblx0XHRcdHByb3ZpZGVyc1N0YXR1c0xvb3BXb3JrZXIuJHN0YXR1cy5yZW1vdmVDbGFzcygnZ3JlZW4nKS5yZW1vdmVDbGFzcygneWVsbG93JykuYWRkQ2xhc3MoJ2dyZXknKTtcblx0XHR9IGVsc2UgaWYgKHJlc3VsdFswXSAhPT0gdW5kZWZpbmVkICYmIHJlc3VsdFswXS5zdGF0ZS50b1VwcGVyQ2FzZSgpID09PSAnUkVHSVNURVJFRCcpIHtcblx0XHRcdHByb3ZpZGVyc1N0YXR1c0xvb3BXb3JrZXIuJHN0YXR1cy5yZW1vdmVDbGFzcygnZ3JleScpLnJlbW92ZUNsYXNzKCd5ZWxsb3cnKS5hZGRDbGFzcygnZ3JlZW4nKTtcblx0XHR9IGVsc2UgaWYgKHJlc3VsdFswXSAhPT0gdW5kZWZpbmVkICYmIHJlc3VsdFswXS5zdGF0ZS50b1VwcGVyQ2FzZSgpID09PSAnT0snKSB7XG5cdFx0XHRwcm92aWRlcnNTdGF0dXNMb29wV29ya2VyLiRzdGF0dXMucmVtb3ZlQ2xhc3MoJ2dyZXknKS5yZW1vdmVDbGFzcygnZ3JlZW4nKS5hZGRDbGFzcygneWVsbG93Jyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHByb3ZpZGVyc1N0YXR1c0xvb3BXb3JrZXIuJHN0YXR1cy5yZW1vdmVDbGFzcygnZ3JlZW4nKS5yZW1vdmVDbGFzcygneWVsbG93JykuYWRkQ2xhc3MoJ2dyZXknKTtcblx0XHR9XG5cblx0XHRpZiAocHJvdmlkZXJzU3RhdHVzTG9vcFdvcmtlci4kc3RhdHVzLmhhc0NsYXNzKCdncmVlbicpKSB7XG5cdFx0XHRwcm92aWRlcnNTdGF0dXNMb29wV29ya2VyLiRzdGF0dXMuaHRtbChnbG9iYWxUcmFuc2xhdGUucHJfT25saW5lKTtcblx0XHR9IGVsc2UgaWYgKHByb3ZpZGVyc1N0YXR1c0xvb3BXb3JrZXIuJHN0YXR1cy5oYXNDbGFzcygneWVsbG93JykpIHtcblx0XHRcdHByb3ZpZGVyc1N0YXR1c0xvb3BXb3JrZXIuJHN0YXR1cy5odG1sKGdsb2JhbFRyYW5zbGF0ZS5wcl9XaXRob3V0UmVnaXN0cmF0aW9uKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cHJvdmlkZXJzU3RhdHVzTG9vcFdvcmtlci4kc3RhdHVzLmh0bWwoZ2xvYmFsVHJhbnNsYXRlLnByX09mZmxpbmUpO1xuXHRcdH1cblx0fSxcbn07XG5cblxuJChkb2N1bWVudCkucmVhZHkoKCkgPT4ge1xuXHRwcm92aWRlcnNTdGF0dXNMb29wV29ya2VyLmluaXRpYWxpemUoKTtcbn0pOyJdfQ==