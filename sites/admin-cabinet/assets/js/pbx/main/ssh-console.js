"use strict";

/*
 * MikoPBX - free phone system for small business
 * Copyright (C) 2017-2020 Alexey Portnov and Nikolay Beketov
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along with this program.
 * If not, see <https://www.gnu.org/licenses/>.
 */

/* global globalSSHPort */
var sshConsole = {
  $menuLink: $('a[href$="/admin-cabinet/console/index/"]'),
  link: null,
  target: null,
  hide: false,
  initialize: function initialize() {
    $('body').on('click', 'a[href$="/admin-cabinet/console/index/"]', function (e) {
      e.preventDefault();
      window.open(sshConsole.link, sshConsole.target);
    }); // Проверим возможность запуска SSH

    var isChrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor) && !navigator.userAgent.match(/Opera|OPR\//); //const isSafari = navigator.vendor && navigator.vendor.indexOf('Apple') > -1 && navigator.userAgent && !navigator.userAgent.match('CriOS');

    if (isChrome) {
      sshConsole.detect('chrome-extension://iodihamcpbpeioajjeobimgagajmlibd', function () {
        sshConsole.link = "ssh://root@".concat(window.location.hostname, ":").concat(globalSSHPort);
        sshConsole.target = '_blank';
      }, function () {
        sshConsole.link = 'https://chrome.google.com/webstore/detail/iodihamcpbpeioajjeobimgagajmlibd';
        sshConsole.target = '_blank';
      });
    } else {
      sshConsole.$menuLink.hide();
    }
  },
  detect: function detect(base, ifInstalled, ifNotInstalled) {
    $.get("".concat(base, "/html/nassh.html")).done(ifInstalled).fail(ifNotInstalled);
  }
};
$(document).ready(function () {
  sshConsole.initialize();
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9tYWluL3NzaC1jb25zb2xlLmpzIl0sIm5hbWVzIjpbInNzaENvbnNvbGUiLCIkbWVudUxpbmsiLCIkIiwibGluayIsInRhcmdldCIsImhpZGUiLCJpbml0aWFsaXplIiwib24iLCJlIiwicHJldmVudERlZmF1bHQiLCJ3aW5kb3ciLCJvcGVuIiwiaXNDaHJvbWUiLCJ0ZXN0IiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwidmVuZG9yIiwibWF0Y2giLCJkZXRlY3QiLCJsb2NhdGlvbiIsImhvc3RuYW1lIiwiZ2xvYmFsU1NIUG9ydCIsImJhc2UiLCJpZkluc3RhbGxlZCIsImlmTm90SW5zdGFsbGVkIiwiZ2V0IiwiZG9uZSIsImZhaWwiLCJkb2N1bWVudCIsInJlYWR5Il0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFFQSxJQUFNQSxVQUFVLEdBQUc7QUFDbEJDLEVBQUFBLFNBQVMsRUFBRUMsQ0FBQyxDQUFDLDBDQUFELENBRE07QUFFbEJDLEVBQUFBLElBQUksRUFBRSxJQUZZO0FBR2xCQyxFQUFBQSxNQUFNLEVBQUUsSUFIVTtBQUlsQkMsRUFBQUEsSUFBSSxFQUFFLEtBSlk7QUFLbEJDLEVBQUFBLFVBTGtCLHdCQUtMO0FBQ1pKLElBQUFBLENBQUMsQ0FBQyxNQUFELENBQUQsQ0FBVUssRUFBVixDQUFhLE9BQWIsRUFBc0IsMENBQXRCLEVBQWtFLFVBQUNDLENBQUQsRUFBTztBQUN4RUEsTUFBQUEsQ0FBQyxDQUFDQyxjQUFGO0FBQ0FDLE1BQUFBLE1BQU0sQ0FBQ0MsSUFBUCxDQUFZWCxVQUFVLENBQUNHLElBQXZCLEVBQTZCSCxVQUFVLENBQUNJLE1BQXhDO0FBQ0EsS0FIRCxFQURZLENBS1o7O0FBQ0EsUUFBTVEsUUFBUSxHQUFHLFNBQVNDLElBQVQsQ0FBY0MsU0FBUyxDQUFDQyxTQUF4QixLQUFzQyxhQUFhRixJQUFiLENBQWtCQyxTQUFTLENBQUNFLE1BQTVCLENBQXRDLElBQTZFLENBQUVGLFNBQVMsQ0FBQ0MsU0FBVixDQUFvQkUsS0FBcEIsQ0FBMEIsYUFBMUIsQ0FBaEcsQ0FOWSxDQU9aOztBQUNBLFFBQUlMLFFBQUosRUFBYztBQUNiWixNQUFBQSxVQUFVLENBQUNrQixNQUFYLENBQ0MscURBREQsRUFFQyxZQUFNO0FBQ0xsQixRQUFBQSxVQUFVLENBQUNHLElBQVgsd0JBQWdDTyxNQUFNLENBQUNTLFFBQVAsQ0FBZ0JDLFFBQWhELGNBQTREQyxhQUE1RDtBQUNBckIsUUFBQUEsVUFBVSxDQUFDSSxNQUFYLEdBQW9CLFFBQXBCO0FBQ0EsT0FMRixFQU1DLFlBQU07QUFDTEosUUFBQUEsVUFBVSxDQUFDRyxJQUFYLEdBQWtCLDRFQUFsQjtBQUNBSCxRQUFBQSxVQUFVLENBQUNJLE1BQVgsR0FBb0IsUUFBcEI7QUFDQSxPQVRGO0FBV0EsS0FaRCxNQVlPO0FBQ05KLE1BQUFBLFVBQVUsQ0FBQ0MsU0FBWCxDQUFxQkksSUFBckI7QUFDQTtBQUNELEdBNUJpQjtBQTZCbEJhLEVBQUFBLE1BN0JrQixrQkE2QlhJLElBN0JXLEVBNkJMQyxXQTdCSyxFQTZCUUMsY0E3QlIsRUE2QndCO0FBQ3pDdEIsSUFBQUEsQ0FBQyxDQUFDdUIsR0FBRixXQUFTSCxJQUFULHVCQUNFSSxJQURGLENBQ09ILFdBRFAsRUFFRUksSUFGRixDQUVPSCxjQUZQO0FBR0E7QUFqQ2lCLENBQW5CO0FBcUNBdEIsQ0FBQyxDQUFDMEIsUUFBRCxDQUFELENBQVlDLEtBQVosQ0FBa0IsWUFBTTtBQUN2QjdCLEVBQUFBLFVBQVUsQ0FBQ00sVUFBWDtBQUNBLENBRkQiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogTWlrb1BCWCAtIGZyZWUgcGhvbmUgc3lzdGVtIGZvciBzbWFsbCBidXNpbmVzc1xuICogQ29weXJpZ2h0IChDKSAyMDE3LTIwMjAgQWxleGV5IFBvcnRub3YgYW5kIE5pa29sYXkgQmVrZXRvdlxuICpcbiAqIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5XG4gKiBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieVxuICogdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMyBvZiB0aGUgTGljZW5zZSwgb3JcbiAqIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uXG4gKlxuICogVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsXG4gKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZlxuICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZVxuICogR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy5cbiAqXG4gKiBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS5cbiAqIElmIG5vdCwgc2VlIDxodHRwczovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uXG4gKi9cblxuLyogZ2xvYmFsIGdsb2JhbFNTSFBvcnQgKi9cblxuY29uc3Qgc3NoQ29uc29sZSA9IHtcblx0JG1lbnVMaW5rOiAkKCdhW2hyZWYkPVwiL2FkbWluLWNhYmluZXQvY29uc29sZS9pbmRleC9cIl0nKSxcblx0bGluazogbnVsbCxcblx0dGFyZ2V0OiBudWxsLFxuXHRoaWRlOiBmYWxzZSxcblx0aW5pdGlhbGl6ZSgpIHtcblx0XHQkKCdib2R5Jykub24oJ2NsaWNrJywgJ2FbaHJlZiQ9XCIvYWRtaW4tY2FiaW5ldC9jb25zb2xlL2luZGV4L1wiXScsIChlKSA9PiB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR3aW5kb3cub3Blbihzc2hDb25zb2xlLmxpbmssIHNzaENvbnNvbGUudGFyZ2V0KTtcblx0XHR9KTtcblx0XHQvLyDQn9GA0L7QstC10YDQuNC8INCy0L7Qt9C80L7QttC90L7RgdGC0Ywg0LfQsNC/0YPRgdC60LAgU1NIXG5cdFx0Y29uc3QgaXNDaHJvbWUgPSAvQ2hyb21lLy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpICYmIC9Hb29nbGUgSW5jLy50ZXN0KG5hdmlnYXRvci52ZW5kb3IpICYmICEobmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvT3BlcmF8T1BSXFwvLykpO1xuXHRcdC8vY29uc3QgaXNTYWZhcmkgPSBuYXZpZ2F0b3IudmVuZG9yICYmIG5hdmlnYXRvci52ZW5kb3IuaW5kZXhPZignQXBwbGUnKSA+IC0xICYmIG5hdmlnYXRvci51c2VyQWdlbnQgJiYgIW5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goJ0NyaU9TJyk7XG5cdFx0aWYgKGlzQ2hyb21lKSB7XG5cdFx0XHRzc2hDb25zb2xlLmRldGVjdChcblx0XHRcdFx0J2Nocm9tZS1leHRlbnNpb246Ly9pb2RpaGFtY3BicGVpb2FqamVvYmltZ2FnYWptbGliZCcsXG5cdFx0XHRcdCgpID0+IHtcblx0XHRcdFx0XHRzc2hDb25zb2xlLmxpbmsgPSBgc3NoOi8vcm9vdEAke3dpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZX06JHtnbG9iYWxTU0hQb3J0fWA7XG5cdFx0XHRcdFx0c3NoQ29uc29sZS50YXJnZXQgPSAnX2JsYW5rJztcblx0XHRcdFx0fSxcblx0XHRcdFx0KCkgPT4ge1xuXHRcdFx0XHRcdHNzaENvbnNvbGUubGluayA9ICdodHRwczovL2Nocm9tZS5nb29nbGUuY29tL3dlYnN0b3JlL2RldGFpbC9pb2RpaGFtY3BicGVpb2FqamVvYmltZ2FnYWptbGliZCc7XG5cdFx0XHRcdFx0c3NoQ29uc29sZS50YXJnZXQgPSAnX2JsYW5rJztcblx0XHRcdFx0fSxcblx0XHRcdCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHNzaENvbnNvbGUuJG1lbnVMaW5rLmhpZGUoKTtcblx0XHR9XG5cdH0sXG5cdGRldGVjdChiYXNlLCBpZkluc3RhbGxlZCwgaWZOb3RJbnN0YWxsZWQpIHtcblx0XHQkLmdldChgJHtiYXNlfS9odG1sL25hc3NoLmh0bWxgKVxuXHRcdFx0LmRvbmUoaWZJbnN0YWxsZWQpXG5cdFx0XHQuZmFpbChpZk5vdEluc3RhbGxlZCk7XG5cdH0sXG59O1xuXG5cbiQoZG9jdW1lbnQpLnJlYWR5KCgpID0+IHtcblx0c3NoQ29uc29sZS5pbml0aWFsaXplKCk7XG59KTtcbiJdfQ==